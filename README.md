# Проект: HTTP-клиент на Scala Native
[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=Goldmak_scala-native&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=Goldmak_scala-native)

Этот проект является простым примером консольного приложения на Scala, скомпилированного в нативный исполняемый файл с помощью Scala Native. Приложение отправляет HTTP GET-запрос, получает и парсит JSON-ответ.

## 1. Пререквизиты (Системные требования)
Для сборки и запуска проекта необходимы следующие инструменты.

### Bash-скрипт для проверки и установки prereq.sh
Этот скрипт проверит наличие всех необходимых компонентов и, если вы используете систему на базе Debian/Ubuntu,
Как использовать: сделай его исполняемым (chmod +x check_prereqs.sh) и запусти (./check_prereqs.sh).

## 2. Сборка и запуск
Все команды выполняются из корневой папки проекта.
```bash
sbt nativeLink
./target/scala-3.4.2/scala-native-hello-native
```

## 3. Методика отладки типовых ошибок
### Проблема 1: Ошибка разрешения зависимостей (ResolveException: Not Found)
**Симптом:** sbt не может скачать библиотеку.

**Причина:** Несовместимость версий "Золотого Трио": Версия Scala + Версия Scala Native + Версия Библиотеки.

**Решение:**

1.  Зайти на Scaladex.
2.  Найти каждую библиотеку и проверить, какие её версии совместимы с твоей версией Scala (3.x) и Scala Native (0.5).
3.  Подобрать рабочую комбинацию версий в build.sbt и project/plugins.sbt.
4.  Убедиться, что для Scala Native зависимостей используется тройной знак процента (%%%).

### Проблема 2: Ошибки нативной компиляции/компоновки
**Симптом:** sbt скачал зависимости, но сборка падает с ошибкой от clang или ld.

**Причина A:** `fatal error: 'some/file.h' file not found`. Это значит, что отсутствует dev-пакет системной библиотеки.

**Решение:** Найти по имени файла (curl.h -> libcurl) соответствующий dev-пакет (libcurl4-openssl-dev) и установить его через системный менеджер пакетов (sudo apt-get install ...).

**Причина B:** `/usr/bin/ld: cannot find -l....` Это значит, что компоновщик не может найти саму системную библиотеку. Часто это "зависимость зависимости".

**Решение:** По имени (-lidn2 -> libidn2) найти соответствующий dev-пакет (libidn2-dev) и установить его.

### Проблема 3: Ошибка бинарной несовместимости (binary-incompatible version of NIR)
**Симптом:** Глубокая ошибка AssertionError от самого компилятора Scala Native.

**Причина:** Конфликт версий между плагином sbt-scala-native и системными библиотеками Scala Native (nativelib, javalib), которые "притащила" одна из зависимостей.

**Решение:**

1.  Посмотреть в логе ошибки, какую версию системной библиотеки он пытается использовать (например, nativelib версии 0.5.8).
2.  Обновить версию плагина в project/plugins.sbt до этой же версии (0.5.8).
3.  Если это не помогает, произвести полную очистку кеша: `rm -rf ~/.cache/coursier/`.